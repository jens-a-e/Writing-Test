%% Begin the document based on the review and published state
$if(review)$
\documentclass[manuscript,screen,review,anonymous]{acmart}
$elseif(manuscript)$
\documentclass[manuscript,screen,review]{acmart}
$elseif(published)$
\documentclass[sigconf]{acmart}
$else$
\documentclass[sigconf,$if(anonymous)$anonymous$endif$]{acmart}
$endif$

% Make Pandoc happy
$if(csl-refs)$
% \newlength{\cslhangindent}
% \setlength{\cslhangindent}{1.5em}
% \newlength{\csllabelwidth}
% \setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}%
  {}%
  {\par}
% \newenvironment{CSLReferences}[3] % #1 hanging-ident, #2 entry spacing
%  {% don't indent paragraphs
%   \setlength{\parindent}{0pt}
%   % turn on hanging indent if param 1 is 1
%   \ifodd #1 \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces\fi
%   % set entry spacing
%   \ifnum #2 > 0
%   \setlength{\parskip}{#2\baselineskip}
%   \fi
%  }%
%  {}
\usepackage{calc} % for \widthof, \maxof
% \newcommand{\CSLBlock}[1]{#1\hfill\break}
% \newcommand{\CSLLeftMargin}[1]{\parbox[t]{\maxof{\widthof{#1}}{\csllabelwidth}}{#1}}
% \newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth}{#1}}
% \newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}
\newcommand{\CSLBlock}[1]{#1}
\newcommand{\CSLLeftMargin}[1]{#1}
\newcommand{\CSLRightInline}[1]{#1}
\newcommand{\CSLIndent}[1]{#1}
$endif$
  

%% \BibTeX command to typeset BibTeX logo in the docs
\AtBeginDocument{%
  \providecommand\BibTeX{{%
    \normalfont B\kern-0.5em{\scshape i\kern-0.25em b}\kern-0.8em\TeX}}}

\usepackage{booktabs}
\usepackage{caption}   % http://mirror.easyname.at/ctan/macros/latex/contrib/caption/caption-eng.pdf

\usepackage{balance}  % balancing bibstyles as per request in accepted submission
\usepackage{graphicx}
% % We will generate all images so they have a width \maxwidth. This means
% % that they will get their normal width if they fit onto the page, but
% % are scaled down if they would overflow the margins.
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
\else\Gin@nat@width\fi}
\makeatother
\let\Oldincludegraphics\includegraphics
\renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=\maxwidth]{#1}}

%% These commands are for a PROCEEDINGS abstract or paper.
$for(acm)$
\copyrightyear{$acm.copyrightyear$}
\acmYear{$acm.copyrightyear$}
\setcopyright{$acm.copyright$}
\acmConference[$acm.conference$]{$acm.conferencetitle$}{$acm.date$}{$acm.location$}
\acmBooktitle{$acm.booktitle$}
\acmPrice{$acm.price$}
\acmISBN{$acm.bookisbn$}
\acmDOI{$acm.doi$}
$endfor$

$for(header-includes)$
$header-includes$
$endfor$

% $if(final)$
%   $if(poster)$
%     \settopmatter{printacmref=false, printfolios=false}
%   $else$
%     \settopmatter{printacmref=true}
%   $endif$
% $endif$

$if(acmauthoryear)$
% \citestyle{acmauthoryear}
$endif$

\begin{document}

% $if(final)$
%   \fancyhead{}
% $endif$

$if(title)$
  \title{$title$}
$endif$
$if(subtitle)$
  \subtitle{$subtitle$}
$endif$

$for(author)$
\author{$author.name$}
$if(author.orcid)$
\orcid{$author.orcid$}
$endif$
$if(author.authornote)$
\authornote{$author.authornote$}
$endif$
$if(author.authornotemark)$
\authornotemark[$author.authornotemark$]
$endif$
\email{$author.email$}
$if(author.institution)$
\affiliation{
  $if(author.institution)$
  \institution{$author.institution$}
  $endif$
  $if(author.department)$
  \institution{$author.department$}
  $endif$
  $if(author.city)$
  \city{$author.city$}
  $endif$
  $if(author.country)$
  \country{$author.country$}
  $endif$
}
$endif$
$endfor$

$if(abstract)$
\begin{abstract}
$abstract$
\end{abstract}
$endif$

\renewcommand{\shortauthors}{$shortauthors$}

\maketitle

$if(CCS)$
$CCS$
$endif$

$if(keywords)$
\keywords{$keywords$}
$endif$

% Main body of the document
$body$

$if(bibliography)$
  \section{References}
  \balance
  \bibliographystyle{ACM-Reference-Format}
  \bibliography{$bibliography$}
$endif$

\end{document}
\endinput
